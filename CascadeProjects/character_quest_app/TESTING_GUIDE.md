# Character Quest App テストガイド

## 認証フローテスト

### 前提条件
- Supabaseプロジェクトが設定済み
- データベーススキーマが適用済み
- アプリが起動中（http://localhost:8080）

### 1. 新規ユーザー登録テスト

#### テスト手順
1. アプリにアクセス（http://localhost:8080）
2. 認証画面が表示されることを確認
3. 「アカウントをお持ちでない方は こちら」をクリック
4. 以下の情報を入力：
   - 表示名: テストユーザー1
   - メールアドレス: test1@example.com
   - パスワード: Test1234!
5. 「アカウント作成」ボタンをクリック

#### 確認項目
- [ ] 登録が成功する
- [ ] 自動的にダッシュボードに遷移する
- [ ] キャラクターが表示される（レベル1）

#### Supabaseダッシュボードでの確認
1. Authentication → Users
   - 新規ユーザーが作成されている
   - メールアドレスが正しい

2. Table Editor → user_profiles
   - プロファイルが自動作成されている
   - username, display_nameが設定されている

3. Table Editor → characters
   - キャラクターが自動作成されている
   - user_idが正しく設定されている
   - 初期値（level: 1, health: 100など）が正しい

### 2. ログイン/ログアウトテスト

#### ログアウトテスト
1. ダッシュボード右上の3点メニューをクリック
2. 「ログアウト」を選択
3. 確認ダイアログで「ログアウト」をクリック

#### 確認項目
- [ ] 認証画面に戻る
- [ ] セッションがクリアされる

#### ログインテスト
1. 登録したアカウントでログイン
   - メールアドレス: test1@example.com
   - パスワード: Test1234!
2. 「ログイン」ボタンをクリック

#### 確認項目
- [ ] ログインが成功する
- [ ] ダッシュボードに遷移する
- [ ] キャラクター情報が正しく表示される

### 3. エラーケーステスト

#### 無効なメールアドレス
1. 無効なメールアドレスを入力（例：test@）
2. エラーメッセージが表示される

#### 短いパスワード
1. 5文字以下のパスワードを入力
2. 「パスワードは6文字以上で入力してください」が表示される

#### 間違ったログイン情報
1. 存在しないメールアドレスでログイン試行
2. 「メールアドレスまたはパスワードが間違っています」が表示される

### 4. デバッグ機能テスト

#### 認証状態確認
1. 認証画面下部の「認証状態を確認」ボタンをクリック
2. デバッグ情報ダイアログが表示される
3. 以下を確認：
   - Session状態
   - User ID（ログイン時）
   - Supabase URL

### 5. プロファイル画面テスト

#### アクセステスト
1. ダッシュボード → 3点メニュー → プロフィール
2. プロファイル画面が表示される

#### 表示内容確認
- [ ] ユーザー名が表示される
- [ ] レベルとランクが表示される
- [ ] キャラクター統計が表示される

### 6. モバイルビューテスト

#### レスポンシブ確認
1. ブラウザの開発者ツールを開く（F12）
2. モバイルビューに切り替え（Ctrl+Shift+M）
3. 以下を確認：
   - [ ] ドロワーメニューが使用可能
   - [ ] レイアウトが崩れていない

## トラブルシューティング

### 「user_profiles not found」エラー
- データベーススキーマが正しく適用されているか確認
- `supabase_complete_schema.sql`を再実行

### 「Email not confirmed」エラー
- Supabaseダッシュボード → Authentication → Settings
- 「Enable email confirmations」をOFFにする（開発時のみ）

### キャラクターが作成されない
- handle_new_user()トリガーが設定されているか確認
- Table Editor → Database → Functions で確認

## パフォーマンステスト

### 初回ロード時間
- [ ] 3秒以内に認証画面が表示される
- [ ] ログイン後2秒以内にダッシュボードが表示される

### API呼び出し確認
- ネットワークタブでSupabase APIへのリクエストを確認
- 不要な重複リクエストがないか確認

## セキュリティテスト

### RLSポリシー確認
1. 他のユーザーのデータにアクセスできないことを確認
2. 認証なしでAPIにアクセスできないことを確認

### パスワード強度
- 弱いパスワードが拒否されることを確認
- パスワードがマスクされて表示されることを確認

## チェックリスト

### 必須機能
- [x] ユーザー登録
- [x] ログイン/ログアウト
- [x] プロファイル自動作成
- [x] キャラクター自動作成
- [x] 認証ガード
- [x] エラーハンドリング

### UI/UX
- [x] レスポンシブデザイン
- [x] ローディング表示
- [x] エラーメッセージ
- [x] 確認ダイアログ

### 次のステップ
1. タスク/習慣管理機能の実装
2. キャラクター成長システムの実装
3. ゲーミフィケーション要素の追加